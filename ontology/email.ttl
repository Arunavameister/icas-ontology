@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix xml: <http://www.w3.org/XML/1998/namespace> .
@prefix dc: <http://purl.org/dc/elements/1.1/#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix owl2: <http://www.w3.org/2006/12/owl2#> .
@prefix swrlx: <http://www.w3.org/2003/11/swrlx#> .
@prefix event: <http://purl.org/NET/c4dm/event.owl#> .
@prefix time: <http://www.w3.org/2006/time#> .
@prefix foaf: <http://xmlns.com/foaf/0.1/> .
@prefix mere: <http://www.bbn.com/ontologies/domain/foundation/mereology#> .
@prefix tapio: <http://www.invincea.com/ontologies/icas/1.0/tapio#> .
@prefix mime: <http://www.invincea.com/ontologies/icas/1.0/mime#> .
@prefix uri: <http://www.invincea.com/ontologies/icas/1.0/uri#> .
@prefix filesystem: <http://www.invincea.com/ontologies/icas/1.0/filesystem#> .
@prefix dns: <http://www.invincea.com/ontologies/icas/1.0/dns#> .
@prefix ipnet: <http://www.invincea.com/ontologies/icas/1.0/ipnet#> .
@prefix : <http://www.invincea.com/ontologies/icas/1.0/email#> .
@base <http://www.invincea.com/ontologies/icas/1.0/email> .

<http://www.invincea.com/ontologies/icas/1.0/email> 
			rdf:type owl:Ontology ;
			rdfs:label "Email Objects and Services Ontology"@en ;
			rdfs:comment "Ontology for origins, delivery and content of email"@en ;
			dc:description "Ontology for origins, delivery and content of emails"@en ;
			owl:versionInfo "1.0" ;
			dc:creator "Invincea Labs"@en ;
			dc:date "2014" ;
			owl:imports <http://www.invincea.com/ontologies/icas/1.0/dns> ,
						<http://www.invincea.com/ontologies/icas/1.0/filesystem> ,
						<http://www.invincea.com/ontologies/icas/1.0/ipnet> .

			
:Email
			rdf:type owl:Class ;
			rdfs:subClassOf owl:Thing ;
			rdfs:subClassOf mere:ComplexComposite ;
			rdfs:label "Email" ;
			rdfs:comment "A single, complete message, as delivered through a Mail Transport Agent"@en .
		      	
:EmailAddress
			rdf:type owl:Class ;
			rdfs:subClassOf owl:Thing ;
			rdfs:label "Email Address"@en ;
			rdfs:comment "an SMTP email address identifier, as defined in RFC 5321"@en .

:EmailBody
			rdf:type owl:Class ;
			rdfs:subClassOf owl:Thing ;
			rdfs:subClassOf mere:Composite ;
			rdfs:label "Email Body Content"@en ;
			rdfs:comment "This represents the entire content of an email, minus the header content generated by the Mail Transport"@en .

:EmailHeader
			rdf:type owl:Class ;
			rdfs:subClassOf owl:Thing ;
			rdfs:subClassOf mere:Composite ;
			rdfs:label "Email Header"@en ; 
			rdfs:comment "Email headers represent the information appended to the email body, as it passed between Mail Transports"@en .

:headerContent
			rdf:type owl:DatatypeProperty , owl:FunctionalProperty;
			rdfs:label "Email Head Raw Content"@en ;
			rdfs:comment "The raw text content of an Email Header"@en ;
			rdfs:domain :EmailHeader ;
			rdfs:range xsd:string . 

:Recipient
			rdf:type owl:ObjectProperty ;
			rdfs:label "Recipient"@en ;
			rdfs:comment "The email address(es) this email was addressed to (but not necessarily successfully delivered to"@en ;
			rdfs:subPropertyOf mere:directlyPartOf;
			rdfs:domain :Email ;
			tapio:signaturePriority 4 ;
			rdfs:range :EmailAddress .

:Sender 
			rdf:type owl:FunctionalProperty ,   owl:ObjectProperty ;
			rdfs:label "Sent from address"@en ; 
			rdfs:comment "The From: Field in email is absolutely arbitrary, and can be populated with anything that matches the email address format. There is no guarantee it is a legitimate address"@en ;
			rdfs:subPropertyOf mere:directlyPartOf ;
			rdfs:domain :Email ;
			tapio:signaturePriority 3 ;
			rdfs:range :EmailAddress .

:To
			rdf:type owl:ObjectProperty ;
			rdfs:label "Primary Recipient"@en ; 
			tapio:signaturePriority 2 ;
			rdfs:comment "The To: recipient list in an email indicates the primary recipients of the email."@en ;
			rdfs:subPropertyOf :Recipient ;
			rdfs:subPropertyOf mere:directlyPartOf .

:BCC
			rdf:type owl:ObjectProperty ;
			rdfs:label "Blind Carbon Copy Recipient"@en ;
			rdfs:comment "The BCC field is stripped from email after being relayed from the initial source, as each BCC recipient recieves an email addressed only to them."@en ;
			rdfs:subPropertyOf :Recipient ;
			rdfs:subPropertyOf mere:directlyPartOf .

:CC 
			rdf:type owl:ObjectProperty ;
			rdfs:label "Carbon Copy Recipient"@en ;
			rdfs:comment "the CC field is retained in delivered emails, recipients will see all other addresses contained in the CC: field in the delivered email"@en ;
			rdfs:subPropertyOf :Recipient ;
			rdfs:subPropertyOf mere:directlyPartOf .

:Subject
			rdf:type owl:DatatypeProperty, owl:FunctionalProperty ;
			rdfs:label "Email subject"@en ;
			rdfs:comment "The subject line"@en ;
			rdfs:domain :EmailHeader ;
			rdfs:range xsd:string .

:Status 
			rdf:type owl:DatatypeProperty, owl:FunctionalProperty ;
			rdfs:label "Email read status"@en ;
			rdfs:comment "The message status -- read, unread, etc"@en ;
			rdfs:domain :Email ;
			rdfs:range xsd:string .
        
:OriginRelay
			rdf:type owl:FunctionalProperty ,  owl:ObjectProperty ;
			rdfs:label "sent from SMTP relay at"@en ;
			rdfs:comment "The address of the SMTP Server that accepted and relayed the email"@en ;
			rdfs:domain :EmailHeader ;
			rdfs:range ipnet:Address, dns:A .

:Origination
			rdf:type owl:FunctionalProperty , owl:ObjectProperty ;
			rdfs:label "sent from mail client at"@en ;
			rdfs:domain :EmailHeader ;
			rdfs:range ipnet:Address, dns:A .

:containsFile
			rdf:type owl:ObjectProperty ;
			rdfs:label "has attachment"@en ;
			rdfs:comment "the email body contains a MIME-encoded attached file"@en ;
			rdfs:subPropertyOf mere:directlyHasPart ;
			rdfs:domain :EmailBody ;
			rdfs:range filesystem:File .

:containsURL 
			rdf:type owl:ObjectProperty ;
			rdfs:label "contains URL"@en ;
			rdfs:comment "the email body contains a link to a URL"@en ;
			rdfs:subPropertyOf mere:directlyHasPart ;
			rdfs:domain :EmailBody ;
			rdfs:range uri:URL .

:containsType
			rdf:type owl:ObjectProperty ;
			rdfs:label "contains MIME subsection"@en ; 
			rdfs:comment "this email body contains a MIME-encoded section of data, typically an inline image or other attachment"@en ;
			rdfs:domain :EmailBody ;
			rdfs:range mime:MIMEtype .

:hasHeader
			rdf:type owl:ObjectProperty ;
			rdfs:comment "extracted/parsed headers"@en ; 
			rdfs:label "has header"@en ;
			rdfs:subPropertyOf mere:directlyHasPart ;
			rdfs:domain :Email ;
			rdfs:range :EmailHeader .
              
:onDomain
			rdf:type owl:ObjectProperty ;
			rdfs:comment "The domain portion of an email Address"@en ;
			rdfs:label "on domain"@en ; 
			rdfs:domain :EmailAddress ;
			rdfs:range dns:Domain .

:returnPath
			rdf:type owl:ObjectProperty ,  owl:FunctionalProperty;
			rdfs:label "Return Path"@en ;
			rdfs:comment "The address that responses to this email should be sent to"@en ;
			rdfs:domain :EmailHeader ;
			rdfs:range :EmailAddress .

:bodyContent
			rdf:type owl:DatatypeProperty , owl:FunctionalProperty;
			rdfs:label "Body Content"@en ;
			rdfs:comment "The raw content of the email body" ;
			rdfs:domain :EmailBody ;
			rdfs:range xsd:string .

:messageID 
			rdf:type owl:DatatypeProperty , owl:FunctionalProperty;
			rdfs:label "Message ID"@en ;
			rdfs:comment "Message ID String - these are considered best-effort to be globally unique"@en ;
			rdfs:domain :EmailHeader ;
			tapio:signaturePriority 1 ;
			rdfs:range xsd:normalizedString .

:hasSpoolfile 
			rdf:type owl:ObjectProperty ;
			rdfs:comment "the spool file the email message was found in"@en ;
			rdfs:label "extracted from spool file"@en ; 
			rdfs:subPropertyOf mere:directlyPartOf ;
			rdfs:domain :Email ;
			rdfs:range filesystem:File .

