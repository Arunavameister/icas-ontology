@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix xml: <http://www.w3.org/XML/1998/namespace> .
@prefix dc: <http://purl.org/dc/elements/1.1/#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix owl2: <http://www.w3.org/2006/12/owl2#> .
@prefix swrl: <http://www.w3.org/2003/11/swrl#> .
@prefix swrlx: <http://www.w3.org/2003/11/swrlx#> .
@prefix swrlb: <http://www.w3.org/2003/11/swrlb#> .
@prefix event: <http://purl.org/NET/c4dm/event.owl#> .
@prefix time: <http://www.w3.org/2006/time#> .
@prefix foaf: <http://xmlns.com/foaf/0.1/> .

@prefix mere: <http://www.bbn.com/ontologies/domain/foundation/mereology#> .
@prefix tapio: <http://www.invincea.com/ontologies/icas/1.0/tapio#> .
@prefix ipnet: <http://www.invincea.com/ontologies/icas/1.0/ipnet#> .
@prefix host: <http://www.invincea.com/ontologies/icas/1.0/host#> .
@prefix software: <http://www.invincea.com/ontologies/icas/1.0/software#> .

@prefix : <http://www.invincea.com/ontologies/icas/1.0/controls#> .
@base <http://www.invincea.com/ontologies/icas/1.0/controls> .

<http://www.invincea.com/ontologies/icas/1.0/controls> 
			rdf:type owl:Ontology ;
			rdfs:label "Security Controls ontology"@en ;
			rdfs:comment "an ontology describing Security controls and their outputs."@en ;
			dc:description "an ontology describing Security controls and their outputs"@en ;
			owl:versionInfo "1.0" ;
			dc:creator: "Invincea Labs"@en ;
			dc:date "2014" .
			
:SecurityControl 
			rdf:type owl:Class , foaf:Agent ;                 
			rdfs:label "Security Control"@en ;
			rdfs:comment "A technical security control, embodied as active software monitoring the activity of one or more hosts or networks."@en ;
			rdfs:subClassOf owl:Thing .

:CorrectiveSecurityControl 
			rdf:type owl:Class ;
			rdfs:label "Corrective Security Control"@en ;
			rdfs:comment "Corrective Security controls take action (and usually also generate alerts) upon detection of matching conditions"@en ;
			rdfs:subClassOf :SecurityControl .

:DetectiveSecurityControl 
			rdf:type owl:Class ;
			rdfs:label "Detective Security Control"@en ;
			rdfs:comment "Detective Security controls generate alerts upon detection of matching conditions"@en ;
			rdfs:subClassOf :SecurityControl .

:PreventativeSecurityControl 
			rdf:type owl:Class ;
			rdfs:label "Preventative Security Control"@en ;
			rdfs:subClassOf :SecurityControl .

:monitorsSubnet 
			rdf:type owl:ObjectProperty ;
			rdfs:label "monitors subnet"@en ;
			rdfs:comment "this security control has visibility and governance over the following subnet"@en ;
			rdfs:domain :SecurityControl ;
			rdfs:range ipnet:SubNet .

:monitorsHost
			rdf:type owl:ObjectProperty ;
			rdfs:label "monitors host"@en ;
			rdfs:comment "this security control has visibility and governance over the following host"@en ;
			rdfs:domain :SecurityControl ;
			rdfs:range host:Host .			

:enforcesPolicy
			rdf:type owl:ObjectProperty ;
			rdfs:label "enforces policy"@en ;
			rdfs:label "This control is configured with rules described in the following policy group"@en ;
			rdfs:domain :SecurityControl ;
			rdfs:range :Policy .

:runsOnHost 
			rdf:type owl:FunctionalProperty ,  owl:ObjectProperty ;
			rdfs:label "runs on host"@en ;
			rdfs:label "The host that this security control operates from"@en ;
			rdfs:domain :SecurityControl ;
			rdfs:range host:Host .

:Response 
			rdf:type owl:Class ;
			rdfs:label "Response"@en ;
			rdfs:comment "Controls generate Responses according to rule sets - these responses may be passive (alerting) or active (actions)."@en ;
			rdfs:subClassOf event:Event .

:Action
			rdf:type owl:Class ;
        	rdfs:label "Action"@en ;
			rdfs:comment "Alerts are responses from a security control that only inform that a condition described in a rule has been detected"@en ;
        	rdfs:subClassOf :Response .

:Alert
			rdf:type owl:Class ;
			rdfs:label "Alert" ;
			rdfs:comment "Alerts are responses from a security control that only inform that a condition described in a rule has been detected"@en ;
       		rdfs:subClassOf :Response .

:generatedResponse
			rdf:type owl:InverseFunctionalProperty ,  owl:ObjectProperty ;
			rdfs:label "generated action"@en ;
			rdfs:comment "this control generated the following action in response to a rule in its configuration"@en ;
			rdfs:subPropertyOf event:agent_in ;
			rdfs:range :Action, :Alert;
			rdfs:domain :SecurityControl ;
			owl:inverseOf :generatedBy .


:generatedBy 
			rdf:type owl:ObjectProperty ;
			rdfs:label "was generated by"@en ;
			rdfs:comment "this response was generated by this security control"@en ;	
			rdfs:subPropertyOf event:agent;
			rdfs:domain :Response ;
			rdfs:range :SecurityControl ;
			tapio:signaturePriority 1 ;
			owl:inverseOf :generatedResponse .

:hasSource
			rdf:type owl:ObjectProperty, owl:FunctionalProperty ;
			rdfs:subPropertyOf event:factor ;
			rdfs:label "has source"@en ;
			rdfs:comment "this alert was generated as a result of the actions of this source"@en ;
			rdfs:domain :Alert ;
			rdfs:range owl:Thing .

:hasTarget
			rdf:type owl:ObjectProperty ;
			rdfs:subPropertyOf event:factor ;
			rdfs:label "has target"@en ;
			rdfs:comment "this response action was applied to this target "@en ;
			rdfs:domain :Action ;
			rdfs:range owl:Thing .

:Policy
			rdf:type owl:Class ;
			rdfs:label "Policy"@en ;
			rdfs:comment "Policies, in the context of security controls, are grouping objects containing rules, that enforce or detect deviations from a stated organizational policy"@en ;
	                rdfs:subClassOf owl:Thing ;
			rdfs:subClassOf mere:SimpleComposite .

:hasRule
			rdf:type owl:ObjectProperty ;
			owl:inverseOf :inPolicy ;
			rdfs:label "has rule"@en ;
			rdfs:subPropertyOf mere:hasPart ;
			rdfs:comment "Policies contain individual rules that describe the conditions that deviate from (or enforce) the goals of the policy"@en ;
			rdfs:domain :Policy ;
			rdfs:range :Rule .
			
:inPolicy			
			rdf:type owl:ObjectProperty ;
			owl:inverseOf :hasRule ;
			rdfs:label "has rule"@en ;
			rdfs:subPropertyOf mere:partOf ;
			rdfs:comment "Policies contain individual rules that describe the conditions that deviate from (or enforce) the goals of the policy"@en ;
			rdfs:domain :Rule ;
			rdfs:range :Policy .

:Rule
			rdf:type owl:Class ;
			rdfs:label "Rule"@en ;
			rdfs:comment "Security controls produce responses according to conditions described in rules, usually with each rule producing a uniquely-named response"@en ;
			rdfs:subClassOf owl:Thing ;
			rdfs:subClassOf mere:Atom .
:triggeredResponse	
			rdf:type owl:ObjectProperty, owl:InverseFunctionalProperty ;
			rdfs:subClassOf event:factor_in ;
			owl:inverseOf :triggeredByRule ;
			rdfs:label "triggered response"@en ;
			rdfs:comment "this rule defines the matching conditions that caused the security control to create this response"@en ;
			rdfs:domain :Rule ;
			rdfs:range :Response .

:triggeredByRule
			rdf:type owl:ObjectProperty, owl:FunctionalProperty ;
			rdfs:subClassOf event:factor ;
			owl:inverseOf :triggeredResponse;
			rdfs:label "was triggered by rule"@en ;
			rdfs:comment "this response was triggered by conditions by conditions described in this rule"@en ;
			rdfs:domain :Response ;
			rdfs:range :Rule .

:ruleID 	
			rdf:type owl:DatatypeProperty , owl:FunctionalProperty ;
			rdfs:label "Rule ID"@en ;
			rdfs:comment "Controls typically have rule sets that govern how and what they respond to. This field is used to identify the particular rule this response was generated via, using the identity native to the source control"@en ;
			rdfs:domain :Rule ;
			rdfs:range xsd:normalizedString ;
			rdfs:subPropertyOf event:literal_factor .

